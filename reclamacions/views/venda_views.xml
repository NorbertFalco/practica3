<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- Heredar la vista del formulario de la orden de venta para agregar el campo 'gat' -->
        <record id="view_order_form_inherit_gat" model="ir.ui.view">
            <field name="name">sale.order.form.inherit.gat</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/> <!-- Referencia a la vista original que quieres extender -->
            <field name="arch" type="xml">
                <!-- Usar XPath para encontrar la ubicación donde quieras insertar el campo 'gat' -->
                <!-- Este ejemplo añade el campo 'reclamacions' al final del formulario, pero puedes ajustar el XPath según necesites -->
                <xpath expr="//notebook" position="inside">
                    <page string="Reclamacions">
                        <field name="reclamacions_ids"/>
                    </page>
                </xpath>
            </field>
        </record>
        <record id="view_order_form_inherit_confirm_invoice" model="ir.ui.view">
            <field name="name">sale.order.form.inherit.confirm_invoice</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <!-- Agregar un botón para confirmar la factura -->
                <xpath expr="//button[@name='action_confirm']" position="after">
                    <button name="action_confirm_invoice" string="Confirmar Factura" type="object" class="oe_highlight"/>
                    <field name="invoice_id"/>
                </xpath>
            </field>
        </record>

        <record id="email_template_order_cancellation" model="mail.template">
            <field name="name">Cancelación de Orden de Venta</field>
            <field name="email_from">${(object.user_id.email or object.company_id.email)|safe}</field>
            <field name="subject">Cancelación de Orden #{object.name}</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="auto_delete" eval="True"/>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html">
                <![CDATA[
                <p>Hola ${object.partner_id.name},</p>
                <p>Lamentem informar-vos que el vostre ordre de venda <strong>${object.name}</strong> ha estat cancel·lada.</p>
                <p>Aquí pots incloure més detalls o passos a seguir després de la cancel·lació.</p>
                <p>Si teniu alguna pregunta o necessiteu assistència, no dubteu a contactar-nos a <a href="mailto:${(object.user_id.email or object.company_id.email)|safe}">${(object.user_id.email or object.company_id.email)|safe}</a>.</p>
                <p>Gràcies per la vostra comprensió.</p>
                ]]>
            </field>
        </record>
    </data>
</odoo>
